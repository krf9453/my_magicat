<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>AR + Unity Integration</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

    <style>
      body {
        margin: 0;
        overflow: hidden;
      }

      #unity-canvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1; /* Ensure Unity canvas is above A-Frame scene */
        background-color: transparent; /* Force transparency */
      }

      #aframe-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0; /* Ensure A-Frame scene is below Unity canvas */
      }
    </style>
  </head>
  <body>
    <!-- A-Frame AR.js Scene -->
    <div id="aframe-container">
      <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
        <a-marker preset="hiro">
          <a-box position="0 0.5 0" material="color: red;"></a-box>
        </a-marker>
        <a-entity camera></a-entity>
      </a-scene>
    </div>

    <!-- Unity WebGL Canvas -->
    <div id="unity-container">
      <canvas id="unity-canvas"></canvas>
    </div>

    <script>
      var buildUrl = "Build";
      var loaderUrl = buildUrl + "/build magicat.loader.js";
      var config = {
        dataUrl: buildUrl + "/build magicat.data",
        frameworkUrl: buildUrl + "/build magicat.framework.js",
        codeUrl: buildUrl + "/build magicat.wasm",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "DefaultCompany",
        productName: "My project",
        productVersion: "0.1",
        webglContextAttributes: {
          alpha: true // Ensures the WebGL context supports transparency
        }
      };

      var container = document.querySelector("#unity-container");
      var canvas = document.querySelector("#unity-canvas");
      var unityInstance = null;

      var script = document.createElement("script");
      script.src = loaderUrl;
      script.onload = () => {
        createUnityInstance(canvas, config, (progress) => {
          // Optional: Update any loading progress here
        }).then((instance) => {
          unityInstance = instance;
        }).catch((message) => {
          alert(message);
        });
      };
      document.body.appendChild(script);
    </script>
  </body>
</html>



